
# vue3的设计过程

### 1.为什么要进行代码重构
1.利用新的语言功能  
  1.1 ES6标准化的推进，es语言获得了重大改进，同时主浏览器普遍提供的新的js语言功能提供支持，如Proxy，它允许框架拦截对象上的操作，vue核心功能是能够监听对用户定义状态所做的更改并以数据驱动更新DOM的能力，vue2通过数据劫持来实现，存在一定缺陷如对数据下标操作或者新增对象属性时无法进行监听，切换到代理将会消除这种限制；  
2.解决架构问题  
  2.1 模版编译器的编写方式令源映射的支持非常困难，同时，vue2从技术上允许构建针对非DOM平台的更高级别的渲染器，但必须通过派生代码库并复制大量代码才能实现，等同于重写；  
  2.2 vue2以各种模块的内部与浮动代码之间隐式耦合的形式积累了隐患，浮动代码不属于任何模块，这是得鼓励的理解代码库的一部分变得更加困难，贡献者很少会对重要的更改充满信心；  
  2.3 vue3根据这些事项来重新考虑代码的组织；  

### 1.vue3 初始阶段
1.切换到typescript  
  1.1 类型检查减少开发过程中出现意外错误的机会，帮助贡献者更好的进行代码提供；  
  1.2 为什么放弃facebook的Flow类型检查，因为它可以逐步添加到现有的js项目，刚开始兼容比较好，但是随着项目的推进，特别是不断变化的需求，升级变得很痛苦；此外ts和vs code深度集成，而Flow对集成开发环境支持不够理想；  
  1.3 用户越来越多的使用vue 和ts，为了支持他们的用例，兼容与不同类型系统分开创作和维护ts声明，使用ts的vue3能自动生成声明文件，极大的减轻维护负担；  
2.结构内部封装  
  2.1 采用monorepo，其中的框架由内部软件包组成，每个内部软件包都具有自己独立API，类型定义和测试；这使得模块之间的依赖关系更加明确，开发人员更容易阅读理解请对其进行更改，从而降低项目贡献壁垒提高长期可维护性；  
3.设置RFC流程  
  3.1 RFC means Request From Comments，请求注释是一堆描述不同请求的文本文件； 
  3.2 2018年底，vue团队有了一个使用【新的数据驱动视图系统】和【虚拟DOM渲染器的工作原理】，为了将他们变成具体设计，让社区参与设计过程的一种方法，更加充分考虑到潜在变化，确保用户能够提供有关重大更改的反馈，vue团队在2019年采用了RFC流程，每个RFC遵循一个模版，其中侧重于动机，设计细节，权衡和采用策略；  
4.更快更小
  4.1 性能对于前端框架至关重要，【新的渲染策略】使其成为可能；  
5.克服虚拟DOM的瓶颈
  5.1 